\documentclass[12pt,reqno]{amsart}

\usepackage{graphicx}
\graphicspath{ {./images/} }

\usepackage{float}
\usepackage{amsfonts,amssymb,amsmath,amsopn,amsthm,graphicx}
\usepackage{amsxtra, mathrsfs}
\usepackage{colordvi}
\usepackage[usenames,dvipsnames]{color}
\usepackage{amsfonts,amssymb,amsbsy,amsmath,amsthm,dsfont}
%%%%%%%%%%%
\usepackage{xspace}
\usepackage{pgfplots}
\usepackage{lipsum}
\usepackage[many]{tcolorbox}
\usetikzlibrary{decorations.pathreplacing}




\linespread{1.1} \numberwithin{equation}{section}


\newcommand\red[1]{\textcolor{red}{#1}}
\newcommand{\Gluck}{Gl\H{u}ck\xspace}
\newcommand{\ra}{def}

\newtcolorbox{leftbrace}{%
	enhanced jigsaw, 
	breakable, % allow page breaks
	frame hidden, % hide the default frame
	overlay={%
		\draw [
		decoration={brace,amplitude=0.5em},
		decorate,
		ultra thick,
		]
		% right line
		(frame.south west)--(frame.north west);
	},
	% paragraph skips obeyed within tcolorbox
	parbox=false,
}


%%%%%%%%%
\usepackage{amssymb,amsmath,graphicx,amsthm,a4wide,wrapfig,caption,subcaption,epstopdf}
%\usepackage{amsmath,amssymb,amsfonts,amscd,hyperref,color}
\usepackage[latin1]{inputenc}
%\usepackage[mtoscr]{mtpro2}
\usepackage{enumitem}

%\usepackage[abs]{overpic}
%\usepackage{graphicx}
%\usepackage{verbatim}
%\usepackage{amscd}
\usepackage{verbatim}
%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%labels%%%%%%%%
%\usepackage[notref,notcite]{showkeys}
%%%%%%%%%%%%%%%




\DeclareRobustCommand{\rchi}{{\mathpalette\irchi\relax}}
\newcommand{\irchi}[2]{\raisebox{\depth}{$#1\chi$}} % inner command, used by \rch
\usepackage{lineno}
\usepackage{textcomp}
\usepackage{mathtools,hyperref}
\usepackage{cleveref}
%\hyperref[label_name]{''link text''}

%\usepackage[utf8]{inputenc}
%\usepackage[english]{babel}
\usepackage{setspace,esint}
%\usepackage{graphicx}
%\usepackage{mathtools}
%\usepackage{caption}
%\usepackage{subcaption}
%\graphicspath{{photos/}}
%\usepackage[usenames, dvipsnames]{color}
%\usepackage{}
%\usepackage{enumitem}
%\newcommand\mysymbol[3]{\protected\gdef#1{#2}%	\item[$#2$]#3}










%%%%%%%%%%%%%%%

%\linespread{1.1} \numberwithin{equation}{section}
%\setlength{\voffset}{-.7truein}
%\setlength{\textheight}{8.8truein}
%\setlength{\textwidth}{6.1truein}
%\setlength{\hoffset}{-.7truein}


%%%%%
\newcommand\blue[1]{\textcolor{blue}{#1}}
%%%%%%%%%%%%%%%%%

\newcommand{\Hmm}[1]{\leavevmode{\marginpar{\tiny%
			$\hbox to 0mm{\hspace*{-0.5mm}$\leftarrow$\hss}%
			\vcenter{\vrule depth 0.1mm height 0.1mm width \the\marginparwidth}%
			\hbox to
			0mm{\hss$\rightarrow$\hspace*{-0.5mm}}$\\\relax\raggedright #1}}}
%%%%%%%%%%%%%%%%%%%%
\newcommand{\wc}{{\overline{\Omega}}}
\newcommand{\bb}{{\mathbf{\bar {b}}}}
\newcommand{\bt}{{\mathbf{\widetilde{b}}}}
\newcommand{\Gwb}{{\overline{\Omega}}}
\newcommand{\Hd}{\,H^1_{\Pw_{\mathrm{Dir}}}(\Gw)}

%%%%%%%%%%%%%%%%%%%%%%%
\newcommand{\im}{\mbox{\upshape Im\ }}
\newcommand{\re}{\mbox{\upshape Re\ }}
\newcommand{\tr}{\mbox{\upshape Tr }}
\newcommand{\Pw}{\partial \Omega}

\newcommand{\A}{\mathbf{A}}
\newcommand{\B}{\mathscr{B}}
\newcommand{\ball}{B}
\newcommand{\C}{\mathbb{C}}
\newcommand{\cl}{\mathrm{cl}}
\newcommand{\D}{{\rm D}}
\newcommand{\rr}{{\rm R}}
\newcommand{\Q}{\mathcal{Q}}
\newcommand{\eps}{\varepsilon}
\newcommand{\I}{\mathbb{I}}
\newcommand{\pd}{\partial}
\newcommand{\F}{\mathcal{F}}

\newcommand{\K}{\mathcal{K}}
\newcommand{\loc}{{\rm loc}}
\newcommand{\mg}{\mathrm{mag}}
\newcommand{\N}{\mathbb{N}}
\newcommand{\ope}{\mathrm{op}}
\newcommand{\R}{\mathbb{R}}
\newcommand{\sph}{\mathcal{L}}
\newcommand{\s}{\mathcal{S}}
\newcommand{\T}{\mathbb{T}}
\newcommand{\Z}{\mathbb{Z}}
\newcommand{\W}{\mathscr{W}}
\newcommand{\id}{\mathds{1}}
\newcommand{\HD}{H^{1}_{\partial \Omega_{D}}(\Gw)}
\newcommand{\curl}{{\bf curl}}
\newcommand{\acurl}{\langle a^{-1},{\bf curl_h}\rangle}
\newcommand{\e}{{\bf E}}
\newcommand{\h}{{\bf H}}
\newcommand{\J}{{\bf J}}
\newcommand{\p}{{\bf P}}
\newcommand{\pwd}{\partial\Omega_{\mathrm{Dir}}}
\newcommand{\pwr}{\partial\Omega_{\mathrm{Rob}}}
\newcommand{\wb}{\overline{\Omega}\setminus \partial\Omega_{\mathrm{Dir}} }
\newcommand{\Dir}{\mathrm{Dir}}

\newcommand{\sign}{\mathrm{sign}\,}

\newtheorem{theorem}{Theorem}[section]
\newtheorem{corollary}[theorem]{Corollary}
\newtheorem{cor}[theorem]{Corollary}
\newtheorem{thm}[theorem]{Theorem}
\newtheorem{lem}[theorem]{Lemma}
\newtheorem{lemma}[theorem]{Lemma}
\newtheorem{proposition}[theorem]{Proposition}
\newtheorem{example}[theorem]{Example}

\newtheorem{definition}[theorem]{Definition}
\newtheorem{defi}[theorem]{Definition}
\newtheorem{remark}[theorem]{Remark}

\newtheorem{rem}[theorem]{Remark}

\newtheorem{remarks}[theorem]{Remarks}


\theoremstyle{definition}

%\newtheorem{remark}[theorem]{Remark}
\newtheorem{assumption}[theorem]{Assumption}
\newtheorem{assumptions}[theorem]{Assumptions}
\newtheorem{defin}[theorem]{Definition}

%%%%%%%%%%%%%%%%%%%%%
\numberwithin{equation}{section}
\newcommand{\diver}{\mathrm{div}\,}
%\newcommand{\loc}{{\mathrm{loc}}}
\newcommand{\RN}[1]{%
	\textup{\uppercase\expandafter{\romannumeral#1}}%
}
\newcommand{\interior}[1]{\accentset{\smash{\raisebox{-0.12ex}{$\scriptstyle\circ$}}}{#1}\rule{0pt}{2.3ex}}

\newcommand{\dx}{\,\mathrm{d}x}
\newcommand{\dy}{\,\mathrm{d}y}
\newcommand{\dz}{\,\mathrm{d}z}
\newcommand{\dt}{\,\mathrm{d}t}
\newcommand{\du}{\,\mathrm{d}u}
\newcommand{\dv}{\,\mathrm{d}v}
\newcommand{\dV}{\,\mathrm{d}V}
\newcommand{\ds}{\,\mathrm{d}s}
\newcommand{\dr}{\,\mathrm{d}r}
\newcommand{\dS}{\,\mathrm{d}S}
\newcommand{\dk}{\,\mathrm{d}k}
\newcommand{\dphi}{\,\mathrm{d}\phi}
\newcommand{\dtau}{\,\mathrm{d}\tau}
\newcommand{\dxi}{\,\mathrm{d}\xi}
\newcommand{\deta}{\,\mathrm{d}\eta}
\newcommand{\dsigma}{\,\mathrm{d}\sigma}
\newcommand{\dtheta}{\,\mathrm{d}\theta}
\newcommand{\dnu}{\,\mathrm{d}\nu}
\newcommand{\dmu}{\,\mathrm{d}\mu}
\newcommand{\drho}{\,\mathrm{d}\rho}
\newcommand{\dvrho}{\,\mathrm{d}\varrho}
\newcommand{\dkappa}{\,\mathrm{d}\kappa}
\newcommand{\intr}[1]{\mathrm{int}(#1)}

%%%%%%%%%%%%%%%%%%%%%%%%
\newcommand{\core}{C_0^{\infty}(\Omega)}
\newcommand{\coredir}{C_0^{\infty}(\overline{\Omega} \setminus \pwd)}
\newcommand{\sob}{W^{1,p}(\Omega)}
\newcommand{\sobloc}{W^{1,p}_{\mathrm{loc}}(\Omega)}
\newcommand{\merhav}{{\mathcal D}^{1,p}}
\newcommand{\be}{\begin{equation}}
	\newcommand{\ee}{\end{equation}}
%\newcommand{\mysection}[1]{\section{#1}\setcounter{equation}{0}}
%%%%%%%%%%%%%%%
\newcommand{\bea}{\begin{eqnarray}}
	\newcommand{\eea}{\end{eqnarray}}
\newcommand{\bean}{\begin{eqnarray*}}
	\newcommand{\eean}{\end{eqnarray*}}
\newcommand{\thkl}{\rule[-.5mm]{.3mm}{3mm}}
%%%%%%%%%%%%%%%%%
\newcommand{\Rob}{\mathrm{Rob}}
\newcommand{\Real}{\mathbb{R}}
\newcommand{\real}{\mathbb{R}}
\newcommand{\Nat}{\mathbb{N}}
\newcommand{\ZZ}{\mathbb{Z}}
\newcommand{\Proof}{\mbox{\noindent {\bf Proof} \hspace{2mm}}}
\newcommand{\mbinom}[2]{\left (\!\!{\renewcommand{\arraystretch}{0.5}
		\mbox{$\begin{array}[c]{c}  #1\\ #2  \end{array}$}}\!\! \right )}
\newcommand{\brang}[1]{\langle #1 \rangle}
\newcommand{\vstrut}[1]{\rule{0mm}{#1mm}}
\newcommand{\rec}[1]{\frac{1}{#1}}
\newcommand{\set}[1]{\{#1\}}
\newcommand{\dist}[2]{\mbox{\rm dist}\,(#1,#2)}
\newcommand{\opname}[1]{\mbox{\rm #1}\,}
\newcommand{\supp}{\opname{supp}}
\newcommand{\mb}[1]{\;\mbox{ #1 }\;}
\newcommand{\undersym}[2]
{{\renewcommand{\arraystretch}{0.5}  \mbox{$\begin{array}[t]{c}
				#1\\ #2  \end{array}$}}}
\newlength{\wex}  \newlength{\hex}
\newcommand{\understack}[3]{%
	\settowidth{\wex}{\mbox{$#3$}} \settoheight{\hex}{\mbox{$#1$}}
	\hspace{\wex}  \raisebox{-1.2\hex}{\makebox[-\wex][c]{$#2$}}
	\makebox[\wex][c]{$#1$}   }%
%%Macros for changing font size in math.
\newcommand{\smit}[1]{\mbox{\small \it #1}}% only for letters, numbers
\newcommand{\lgit}[1]{\mbox{\large \it #1}}% only for letters, numbers
\newcommand{\scts}[1]{\scriptstyle #1}
\newcommand{\scss}[1]{\scriptscriptstyle #1}
\newcommand{\txts}[1]{\textstyle #1}
\newcommand{\dsps}[1]{\displaystyle #1}
\newcommand{\ass}[1]{Let Assumptions~\ref{assump1} hold  in a bounded Lipschitz domain $\Gw$}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%Macros for Greek letters.

%%%%%%%%%%%%%%%%%%%%%%%%%%%
\def\ga{\alpha}     \def\gb{\beta}       \def\gg{\gamma}
\def\gc{\chi}       \def\gd{\delta}      \def\ge{\epsilon}
\def \gth{\theta}                         \def\vge{\varepsilon}
\def\gf{\phi}       \def\vgf{\varphi}    \def\gh{\eta}
\def\gi{\iota}      \def\gk{\kappa}      \def\gl{\lambda}
\def\gm{\mu}        \def\gn{\nu}         \def\gp{\pi}
\def\vgp{\varpi}    \def\gr{\rho}        \def\vgr{\varrho}
\def\gs{\sigma}     \def\vgs{\varsigma}  \def\gt{\tau}
\def\gu{\upsilon}   \def\gv{\vartheta}   \def\gw{\omega}
\def\gx{\xi}        \def\gy{\psi}        \def\gz{\zeta}
\def\Gg{\Gamma}     \def\Gd{\Delta}      \def\Gf{\Phi}
\def\Gth{\Theta}
\def\Gl{\Lambda}    \def\Gs{\Sigma}      \def\Gp{\Pi}
\def\Gw{\Omega}     \def\Gx{\Xi}         \def\Gy{\Psi}
\def\Gwh{\Omega_h}  
\def\lc{\lambda_\mathrm{crit}}

%%%%%%%%%%%%%


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{document}
	
	
	\title{Fourth Order Accurate in Space and Time Compact scheme for First Order Time Dependent Maxwell Equations}
	
	\author {I. Versano}
	
	\address {School of Mathematical Sciences, Tel-Aviv University, Tel-Aviv 6997801, Israel}
	
	\email {idanversano@tauex.tau.ac.il}
	
	\author {E. Turkel}
	
	\address {School of Mathematical Sciences, Tel-Aviv University, Tel-Aviv 6997801, Israel}
	
	\email {turkel@tauex.tau,ac.il}
	
	\author {S. Tsynkov }
	
	\address {North Carolina State University, Box 8205, Raleigh, NC 27695, USA.}
	
	\email {tsynkov@math.ncsu.edu}
	%
	%\author{
		%	I. Versano {}\thanks{Corresponding author.
			%		School of Mathematical Sciences, Tel-Aviv University, Tel-Aviv 6997801, Israel, E-mail: idanv@campus.technion.ac.il} \qquad
		%	E. Turkel {}\thanks{
			%		School of Mathematical Sciences, Tel-Aviv University, Tel-Aviv 6997801, Israel, E-mail: turkel@tauex.tau,ac.il} \qquad
		%	S. Tsynkov {}\thanks{
			%		Department of Mathematics,  North Carolina State University, Box 8205, Raleigh, NC 27695, USA.
			%		tsynkov@math.ncsu.edu} 
		%}
	
	
	
	
	
	%\fi
	
	%%%%%%%%%%%%%%
	
	
	\maketitle
	\begin{abstract}
		
		
		\medskip
		
		\noindent  2000  \! {\em Mathematics  Subject  Classification.}
		.\\[1mm]
		\noindent {\em Keywords:} 
	\end{abstract}
	
	\section{Introduction}
	
	\subsection{Novelties}

	We present new compact fourth-order scheme for Maxwell-equations in $3D$ using equation-based method in staggered grid.
	At each time step we update the solution by solving  elliptic equations. Yet, the selection of appropriate boundary conditions for the elliptic equations are not immediate from the problem's formulation. This ambiguity is treated with the help of energy estimates.
	Another technical   difficulty   arises by the selection of non-symmetric differentiation operator, and has to be treated carefully as well.
	
	\subsection{Maxwell equations}
	Let $\e,\h,\bf{D},\bf{B},\bf{J}$ be (real-valued) vector fields defined in  $[0,\infty)\times\Omega$ and take values in $\R^3$.
	The Maxwell equations (without polarization), in first order differential vector form, are given by
	\begin{align*}
		\frac{\partial \bf{D}}{\partial t} &= \nabla \!\times\! \bf{H} - \bf{J} &
		\frac{\partial B}{\partial t}=-\nabla\times \e &\\
		\bf{B} &= \mu \bf{H} & \bf{D} = \epsilon \bf{E},
	\end{align*}
	with initial conditions given for $\bf{D}$ and $\bf{E}$ at $t=0$.

We assume the following:
\begin{enumerate}
	\item  The functions $\mu,\varepsilon$ are    positive constants satisfying $\frac{1}{\mu \varepsilon}=c^2$.
	\item  $\Omega=[0,1]^3$, $\vec{n} \times {\bf E}=0$ on $\partial \Omega$ (\cite[Section 8]{rolf}).
\end{enumerate}
In fact, the identity $\nabla\cdot (\nabla\times)=0$ implies that one can look for solutions  satisfying $\nabla\cdot \h=0$.
By letting  $ \tau=ct$,  $Z=\sqrt{\mu/\varepsilon}$, we look for a numerical scheme for the following problem.
%$$
%\frac{\partial {\bf E}}{\partial \tau }=Z(\nabla \times \bf{H}-{\bf J}), \quad 
%\frac{\partial {\bf H}}{\partial \tau }=-\frac{1}{Z}\nabla \times {\bf E}.
%$$
	\begin{align}
	\label{eq:maxwellv}
	&\notag
\frac{\partial {\bf E}}{\partial \tau }=Z(\nabla \times \bf{H}-{\bf J}) \quad \mathrm{in} \quad  (0,\infty)\times \Omega,\\&\notag
 \frac{\partial {\bf H}}{\partial \tau }=-\frac{1}{Z}\nabla \times {\bf E} \quad \mathrm{in} \quad  (0,\infty)\times \Omega,\\&\notag
 \e(0,x,y,z)=\e_0 \\& \h(0,x,y,z)=\h_0,\\&\notag
	\nabla\cdot \h(\tau,x,y,z) = 0.\notag
\end{align}




	%\begin{remark}
	%	The invariance of the curl operator to rotations imply that
	%our scheme  can be easily generalized to the  case where $\varepsilon$ and $\mu$ are  uniformly   positive definite matrix functions (cf. \cite[Section 8]{rolf}).
	%\end{remark}
	\section{preliminaries}
	We consider uniform discretization of $\Gw=[0,1]^3$ that is,
	 $\Delta x=\Delta y=\Delta z=h$,
	 $\e_h, \h_h$ correspond to discretized functions corresponding $\e,\h$.
	 From time to time, when there is no danger of ambiguity, we omit the subscript $h$ from $\e_h,\h_h$.
	 We consider $\Delta \tau $ as the time-step.
	Moreover, we   introduce the following notations:
	\begin{itemize}
		\item $\e=(E_x,E_y,E_z)$, $\h=(H_x,H_y,H_z)$
		\item $\e^n$  (resp. $\e^{n+1/2}$) denotes $\e(t=n\Delta \tau)$ (resp. $\e^{(n+1/2)(\Delta \tau}$).
		\item $x_{i}=i h,y_{j}=j h,z_{k}=k h$ 
		\item $x_{i+\frac{1}{2}}=\left (i+\frac{1}{2}\right ) h, y_{j+\frac{1}{2}}=\left (j+\frac{1}{2}\right ) h, z_{k+\frac{1}{2}}=\left (k+\frac{1}{2}\right ) h$ 
		\item 	$[N]=\{0,1,..,N\},\quad N\in \N.$
				\item 	$[k,m]=\{k,k+1,..m\},\quad k<m\in \N.$
	\end{itemize}

	To discretize the equations we introduce a staggered mesh in both space and time as in the Yee scheme \cite{yee}. 
	$\e$ is  evaluated at time $n\Delta \tau$ while $\bf{H}$ and $\bf{J}$ are evaluated at time $(n\!+\! \frac{1}{2})\Delta \tau$.

	
	With this arrangement all space derivatives are spread over a single mesh width and the central time and space derivatives
	are centered at the same point similar to that of the Yee scheme \cite{yee}. 
	We define the following meshes:
	\begin{align*}
		&\Gwh^{E_z}:=\{(x_i,y_j,z_{k+\frac{1}{2}}),\quad (i,j,k)\in [N]^2 \times[N-1]\} \\
		& \Gwh^{E_y}:=\{(x_i,y_{j+\frac{1}{2}},z_{k}), \quad (i,j,k)\in [N]\times [N-1] \times[N] \}\\
		& \Gwh^{E_x}:=\{ (x_{i+\frac{1}{2}},y_{j},z_{k}),\quad (i,j,k) \in [N-1]\times [N]^2 \} \\
		&\Gwh^{H_z}:=\{ (x_{i+\frac{1}{2}},y_{j+\frac{1}{2}},z_{k}),\quad (i,j,k)\in [N-1]^2\times[N] \}\\
		&\Gwh^{H_y}:=\{ (x_{i+\frac{1}{2}},y_j,z_{k+\frac{1}{2}}),\quad (i,j,k) \in [N-1]\times [N] \times [N-1] \}\\
		& \Gwh^{H_x}:=\{ (x_i,y_{j+\frac{1}{2}},z_{k+\frac{1}{2}}), \quad (i,j,k) \in [N]\times [N-1]^2\}.
	\end{align*}
Furthermore,
	\begin{align*}
	&\mathrm{int}(\Gwh^{E_z}):=\{(x_i,y_j,z_{k+\frac{1}{2}}),\quad (i,j,k)\in [1,N-1]^2 \times[1,N-2]\} \\
	&\mathrm{int}( \Gwh^{E_y}):=\{(x_i,y_{j+\frac{1}{2}},z_{k}), \quad (i,j,k)\in [1,N-1]\times [1,N-2] \times[N] \}\\
	& \mathrm{int}(\Gwh^{E_x}):=\{ (x_{i+\frac{1}{2}},y_{j},z_{k}),\quad (i,j,k) \in [1,N-2]\times [1,N-1]^2 \} \\
	&\mathrm{int}(\Gwh^{H_z}):=\{ (x_{i+\frac{1}{2}},y_{j+\frac{1}{2}},z_{k}),\quad (i,j,k)\in [1,N-2]^2\times[1,N-1] \}\\
	&\mathrm{int}(\Gwh^{H_y}):=\{ (x_{i+\frac{1}{2}},y_j,z_{k+\frac{1}{2}}),\quad (i,j,k) \in [1,N-2]\times [1,N-1] \times [1,N-2] \}\\
	& \mathrm{int}(\Gwh^{H_x}):=\{ (x_i,y_{j+\frac{1}{2}},z_{k+\frac{1}{2}}), \quad (i,j,k) \in [1,N-1]\times [1,N-2]^2\}.
\end{align*}
By convection, $x_0=y_0=z_0=0$ and $x_N=y_N=z_N=1$.
	We denote 
$$
\Gwh^{{\bf E}}:=\Gwh^{E_x}\times \Gwh^{E_y}\times \Gwh^{E_z}, \qquad 
\Gwh^{\bf H}:=
\Gwh^{H_x}\times \Gwh^{H_y}\times \Gwh^{H_z},
$$
and 
$$
\mathrm{int}(\Gwh^{{\e}}):=\mathrm{int}(\Gwh^{E_x})\times \mathrm{int}(\Gwh^{E_y})\times \mathrm{int}(\Gwh^{E_z}),
\quad \partial \Gwh^\e:=\Gwh^\e\setminus  \mathrm{int}(\Gwh^{\e})
$$
$$
\mathrm{int}(\Gwh^{\h}):=
\mathrm{int}(\Gwh^{H_x})\times \mathrm{int}(\Gw^{H_y})\times \mathrm{int}(\Gwh^{H_z}),
\quad \partial \Gwh^\h:=\Gwh^\h\setminus  \mathrm{int}(\Gw^{\h})
$$
see Figures \ref{fig:E},\ref{fig:Hx} for illustration of the sets 
$\Gwh^{E_z}, \Gwh^{H_x},\Gwh^{H_y}$ projected on the $x,y$ plane.
{\bf We emphasize that $\partial(\Gwh^\h)$ include points which are not interior points
	 in the physical domain $\Gwh$	 (in the usual topology on $\R^3$). }


    The dicretized functions $\e_h, \h_h$ are then defined as follows:
    $$
    \e_h^n:=\e(n\Delta \tau,\Gwh^\e),\quad  \h_h^{n+\frac{1}{2}}:=\h\left ((n+\frac{1}{2})\Delta \tau,\Gwh^\h)\right).
    $$

	With this arrangement, the boundary condition 
	$\vec{n}\times {\bf E}=0$ on $\partial \Gwh^{{\bf E}}$ readily imply that 
	$E_s=0$ on $\partial \Gwh^{E_s}$ for $s=x,y,z$. That is, 
	\begin{align*}
		&
		E_x(x_{i+\frac{1}{2}},0,z_j)=E_x(x_{i+\frac{1}{2}},N,z_j)=
		E_x(x_{i+\frac{1}{2}},y_j,0)=E_x(x_{i+\frac{1}{2}},y_j, N)=0, \\&
		E_y(0,y_{j+\frac{1}{2}},z_j)=E_y(N,y_{j+\frac{1}{2}},z_j)=
		E_y(x_i,y_{j+\frac{1}{2}},0)=E_y(x_i, y_{j+\frac{1}{2}}, N)=0, \\&
		E_z(0,y_j,z_{k+\frac{1}{2}})=E_x(N,y_j,z_{k+\frac{1}{2}})=
		E_z(x_i,0,z_{k+\frac{1}{2}})=E_z(x_i,N,z_{k+\frac{1}{2}})=0. &
	\end{align*} 

	Next, we consider fourth-order approximation for first derivatives:
	Assume that $f(x)$ is known at N points $x_0,x_1, ..,x_{N-1}$. Then,  one can  estimate  $f'(x+h/2)$ at the $N-1$ points 	$x_{\frac{1}{2}},..,x_{N-3/2}$ to fourth order.
   That is, there exists operators $a$ satisfying $a^{-1}D_xf(x)=f'(x+h/2)+O(h^4)$
   (see Appendix \ref{appendix}). For partial derivatives with respect to $s$ we write $a_s$ as the corresponding operator for evaluating $f_s$. 
   More formally, let $a_{ij}^{-1}$ be the entries of a matrix $a_{ij}$ and let $U(i,j,k)$ be grid function.
   Then 
 $$h\cdot [a_x^{-1}\circ D_xU(i,j,k)]:=\sum_{l} a_{il}^{-1}(U(l+n/2,j,k)-U(l-n/2,j,k)),$$
  $$h\cdot [a_y^{-1}\circ D_yU(i,j,k)]:=\sum_{l} a_{jl}^{-1}(U(i,l+n/2,k)-U(i,l-n/2,k)),$$
   $$h\cdot [a_z^{-1}\circ D_zU(i,j,k)]:=\sum_{l} a_{kl}^{-1}(U(i,j,l+n/2)-U(i,j,l-n/2)).$$

   
   Next, we introduce the following notations:
	\begin{itemize}
		\item $r=\Delta \tau/h$.\\[1mm]
		\item ${\bf x'}=(x_i',y_j',z_k')\in \Gwh^\e\cup\Gwh^\h$\\[1mm]
		\item $\delta_{\tau} U^{n+\frac{1}{2}}:=\frac{U^{n+1}-U^{n}}{\Delta \tau}$\\[1mm]
				\item $D_x U({\bf x'}):=\frac{U(x_i'+h/2,y_j',z_k')-U(x_i'-h/2,y_j',z_k')}{h}$\\[1mm]
	\item $D_y U({\bf x'}):=\frac{U(x_i',y_j'+h/2,z_k')-U(x_i'-h/2,y_j',z_k')}{h}$\\[1mm]
		\item $D_z U({\bf x'}):=\frac{U(x_i',y_j',z_k'+h/2)-U(x_i'-h/2,y_j',z_k')}{h}$\\[1mm]
		\item $\delta_x U:=a_x^{-1}\circ D_xU$\\[1mm]
		\item $\delta_y U:=a_y^{-1}\circ D_y$\\[1mm]
		\item 	$\delta_z U:=a_z^{-1}\circ D_z$\\[1mm]
	\end{itemize}
		Consider  the spaces 
		$$
		V^{\bf{E}}:=\{F \in \Gwh^{\bf{E}}:\|F\|_{\bf{E}}<\infty\}, \qquad 
		V^{\bf{H}}:=\{G \in \Gwh^{\bf{H}}:\|G\|_{\bf{H}}<\infty\}.
		$$
		Let $F,G$ defined in $\Gwh^{\bf{E}}$ and $U,V$ defined in 
		$\Gwh^{\bf{H}}$. Assume that either $F$ or $G$ vanish on $\partial \Gwh^\e$.
		We define the following inner products:
		\begin{align*}
&
		(F,G)_{\Gwh^\e}:=
		h^3\sum_{i=0}^{N-1}\sum_{j=0}^{N-1}\sum_{k=0}^{N-1}
		F_{x,i+\frac{1}{2},j,k}\overline{G}_{x,i+\frac{1}{2},j,k}+
		F_{y,i,j+\frac{1}{2},k}\overline{G}_{y,i,j+\frac{1}{2},k}+F_{z,i,j,k+\frac{1}{2}}\overline{G}_{z,i,j,k+\frac{1}{2}}
	\end{align*}
		\begin{align*}
			&
			(U,V)_{\Gwh^\h}:=\\&
			h^3\sum_{i=0}^{N-1}\sum_{j=0}^{N-1}\sum_{k=0}^{N-1}
			U_{x,i,j+\frac{1}{2},k+\frac{1}{2}}\overline{V}_{x,i,j+\frac{1}{2},k+\frac{1}{2}}+
			U_{y,i+\frac{1}{2},j,k+\frac{1}{2}}\overline{V}_{y,i+\frac{1}{2},j,k+\frac{1}{2}}+U_{z,i+\frac{1}{2},j+\frac{1}{2},k}\overline{V}_{z,i+\frac{1}{2},j+\frac{1}{2},k}.
		\end{align*}
		Since either $F$ or $G$ vanish on $\partial \Gwh^\e$, this inner products are the standard inner products defined by elementwise  multiplications in $\Gwh^\e, \Gwh^\h$.
		Similarly, for any subset $\omega$ of $\Gwh^\e$ or $\Gwh^\h$ we denote by $(\cdot,\cdot)_{\omega}$ the restriction of the  inner product to $\omega$.
		
		
		
		Next, we define 
		$$
		\mathbf{\curl_h}:V^{\bf{E}}\to V^{\bf{H}}, \quad 
		\mathbf{\curl_h'}:V^{\bf{H}}\to V^{\bf{E}},
		$$
		by
		$$
		\mathbf{\curl_h}( resp. \mathbf{\curl_h}')=
		\begin{pmatrix}
			0& -\D_z & \D _y\\
			D_z&0&-D_x\\
			-D_y&D_x&0\\
		\end{pmatrix}.
		$$
		We omit the superscript $'$ where there is no danger of ambiguity.
		
		We notice that 
		\begin{align*}
			&
			\begin{pmatrix}
				0& -\delta_z & \delta _y\\
				\delta_z&0&-\delta_x\\
				-\delta_y&\delta_x&0\\
			\end{pmatrix}=
			\begin{pmatrix}
				0& 0 & 0\\
				0&a_x^{-1}&0\\
				0&0&a_x^{-1}\\
			\end{pmatrix}
			\begin{pmatrix}
				0& 0 & 0\\
				0&0&-D_x\\
				0&D_x&0\\
			\end{pmatrix}+\\&
			\begin{pmatrix}
				a_y^{-1}& 0 & 0\\
				0&0&0\\
				0&0&a_y^{-1}\\
			\end{pmatrix}
			\begin{pmatrix}
				0& 0 & D _y\\
				0&0&0\\
				-D_y&0&0\\
			\end{pmatrix}+
			\begin{pmatrix}
				a_z^{-1}& 0 & 0\\
				0&a_z^{-1}&0\\
				0&0&0\\
			\end{pmatrix}
			\begin{pmatrix}
				0& -D_z & 0\\
				D_z&0&0\\
				0&0&0\\
			\end{pmatrix}.
		\end{align*}
		We then define 
		$$
		<a^{-1},\curl>:=
		\begin{pmatrix}
			0& -\delta_z & \delta _y\\
			\delta_z&0&-\delta_x\\
			-\delta_y&\delta_x&0\\
		\end{pmatrix}.
		$$
		
%		\item $
%		L_{\tau}^h(U):=-
%		\left (
%		\frac{D_{xx}}{1+\frac{h^2}{12}D_{xx}}+\frac{D_{yy}}{1+\frac{h^2}{12}D_{yy}}
%		+\frac{D_{zz}}{1+\frac{h^2}{12}D_{zz}}\right)U
%		+\frac{24}{\Delta \tau^2}U
%		$
%		\item
%		$D_{ss}\phi=\frac{\phi(s+h)-2\phi(s)+\phi(s-h)}{h^2}$ is standard symmetric second derivative operator for $s=x,y,z$ with Dirichlet boundary conditions.


	
	Finally, we define 
	$$
	P({\bf J^{n+\frac{1}{2}}}):=Z\left ( -{\bf J}^{n+\frac{1}{2}}-\nabla div({\bf J}^{n+\frac{1}{2}})+\frac{\partial^2{\bf J}^{n+\frac{1}{2}}}{\partial t^2}\right ).
	$$
   \subsection{Modified Helmholtz equation}
   In the following sections we will exploit fourth-order compact schemes for solving elliptic equations of the form $$-\Delta \phi+k^2\phi=k^2F, \ k>0$$ \cite{singer_turkel}.
%   $-\Delta (\phi-F)+k^2(\phi-F)=\Delta F $.
Let 
$$
\Delta_h:=D_{xx}+D_{yy}+D_{zz}, \quad \Delta^2_h:= D_{zz}D_{xx}+D_{yy}D_{zz}+D_{xx}D_{yy}.
$$
Then the scheme reads as follows.
\begin{align*}
	&
	-\left (
	\Delta_h+\frac{h^2}{6}\Delta^2_h
	\right)\phi_h+
	k^2\left (
	1+\frac{k^2h^2}{12}
	\right)\phi_h=
	k^2\left (
	-1-\frac{k^2h^2}{12}
	-\frac{h^2}{12}\Delta_h
	\right)F_h.
\end{align*}
The latter scheme requires boundary operators for the inhomogeneous term $F$ and for $\phi$. 

Next we introduce the following definition.
	\begin{defi}
	For any $s=x,y,z$ and $I= H_s, E_s,$
	let $$P_{1,h}^{I}, P_{2,h}^{I}:\intr\Gwh^{I}\to \intr\Gwh^{I}$$ be the symmetric operators defined by
	$$
	P_{1,h}^{I}:=-\left (\Delta_h+\frac{h^2}{6}\Delta_h^2\right)+\frac{24}{\Delta \tau^2}\left (
	1+\frac{2}{r^2},
	\right)
	$$
	$$
	P_{2,h}^{I}:=\frac{24}{\Delta \tau^2}\left (
	-1-\frac{2}{r^2}-\frac{h^2}{12}\Delta_h
	\right).
	$$	
	
	%		Let $$L^I:=
	%		\left (\frac{P_1^{I}}{P_2^I}\right)+\left (\frac{P_1^I-P_2^I}{P_2^I}\right)B^I
	%		$$
	
\end{defi}
We recall the following facts ($\sigma$ refers to spectrum):
\begin{align}
	\label{eq:spectrumP}
	\begin{split}
		\sigma(\frac{\Delta \tau^2}{24} P_1)\in [1+\frac{2}{r^2}-4,1+\frac{2}{r^2}+12r] ,
		\\
		\sigma(-\frac{\Delta \tau^2}{24} P_2)\in [1+\frac{2}{r^2}-12r, 1+\frac{2}{r^2}].
	\end{split}
\end{align}
By \eqref{eq:spectrumP}, if $r<\frac{1}{\sqrt[3]{6}}$
then $-P_2, P_1$ are positive definite, and
$$
1<1+\frac{2}{r^2}-12r\leq \|\frac{\Delta \tau^2}{24}P_2\|\leq 1+\frac{2}{r^2},
$$
and 
$$
1<1+\frac{2}{r^2}-4\leq\|\frac{\Delta \tau^2}{24}P_1\|\leq 1+\frac{2}{r^2}+12r.
$$





%with homogeneous  boundary conditions for $v$.
%In the following sections we will use the demand $B_{\phi}=B_{F}$ in our scheme and show how it simplifies the energy estimates. Moreover, this requirement is also consistent with Taylor expansion of the equations. 
%%\begin{proposition}
%	Let 
%	$$
%	P_1:=	\Delta_h+\frac{h^2}{6}\Delta^2_h
%	+
%	k^2\left (
%	1+\frac{h^2}{12}\Delta_h
%	+\delta\frac{h^4}{144}\Delta^2_h
%	\right)
%	$$
%	$$
%	P_2:=1+\frac{h^2}{12}\Delta_h
%	+\delta\frac{h^4}{144}\Delta^2_h.
%	$$
%\end{proposition}
   
%   $$
%-   \left (
%   \frac{D_{xx}\phi}{1+\frac{h^2}{12}D_{xx}}+\frac{D_{yy}\phi}{1+\frac{h^2}{12}D_{yy}}
%   +\frac{D_{zz}\phi}{1+\frac{h^2}{12}D_{zz}}\right)
%   +k^2\phi=F
%   $$
%    \cite{singer_turkel}.
%   Equivalently,
%   \begin{align*}
%&
%-\left(1+\frac{h^2}{12}D_{yy}\right)
%\left(1+\frac{h^2}{12}D_{zz}\right)D_{xx}\phi-
%\left(1+\frac{h^2}{12}D_{xx}\right)
%\left(1+\frac{h^2}{12}D_{zz}\right)D_{yy}\phi\\&
%-\left(1+\frac{h^2}{12}D_{xx}\right)
%\left(1+\frac{h^2}{12}D_{yy}\right)D_{zz}\phi+
%\left(1+\frac{h^2}{12}D_{xx}\right)
%\left(1+\frac{h^2}{12}D_{yy}\right)
%\left(1+\frac{h^2}{12}D_{zz}\right)k^2\phi
%=\\&
%\left(1+\frac{h^2}{12}D_{xx}\right)
%\left(1+\frac{h^2}{12}D_{yy}\right)
%\left(1+\frac{h^2}{12}D_{zz}\right)F.
%\end{align*}
%This can be generalized to 
%\begin{align*}
%	&
%	\left (
%	D_{xx}+D_{yy}+D_{zz}+\frac{h^2}{6}(D_{zz}D_{xx}+D_{zz}D_{yy}+D_{xx}D_{zz})
%	+\gamma\frac{h^4}{48}D_{xx}D_{yy}D_{zz}
%	\right)\phi+\\&
%	k^2\left (
%     1+\frac{h^2}{12}(D_{xx}+D_{yy}+D_{zz})	
%     +\delta\frac{h^4}{144}(D_{xx}D_{yy}+D_{yy}D_{zz}+D_{xx}D_{zz})	
%     +\sigma\frac{h^6}{1728}D_{xx}D_{yy}D_{zz}
%	\right)\phi=\\&
%		\left (
%	1+\frac{h^2}{12}(D_{xx}+D_{yy}+D_{zz})	
%	+\delta_2\frac{h^4}{144}(D_{xx}D_{yy}+D_{yy}D_{zz}+D_{xx}D_{zz})	
%	+\sigma_2\frac{h^6}{1728}D_{xx}D_{yy}D_{zz}
%	\right)F
%\end{align*}
%If we set $\sigma=\sigma_2=\gamma=\delta=0$ 

%If  $k^2\phi=F$ on the boundary then the added boundary terms  
%reads as follows:
%\begin{align*}
%	&\phi_B
%\end{align*}


   
	\section{The scheme}
	Using  Taylor series and the Maxwell equations \eqref{eq:maxwellv} we derive the following non-homogeneous elliptic equations for (see Appendix \ref{appendxib})
$	\delta_{\tau} \bf{E}$, and $\delta_{\tau} \bf{H}$
at each time step
(see Appendix \ref{appendxib}).
	$$
	-\Delta\delta_{\tau} \e^{n+\frac{1}{2}}+\frac{24}{\Delta \tau^2}\delta_{\tau}\e^{n+\frac{1}{2}}=
	Z\frac{24}{\Delta \tau^2}\nabla\times \h^{n+\frac{1}{2}}+P(\J)^{n+\frac{1}{2}}+
	\mathrm{O(\Delta \tau^4+h^4)} \quad {\mathrm in} \quad (0,1)^3,
	$$
		$$
	-\Delta \delta_{\tau}\h^{n+1}+\frac{24}{\Delta \tau^2}\delta_{\tau}\h^{n+1}=
	-\frac{1}{Z}\frac{24}{\Delta \tau^2}\nabla\times \e^{n+1}+
	\mathrm{O(\Delta \tau^4+h^4)} \quad {\mathrm in} \quad (0,1)^3.
	$$


	The resulting scheme reads as follows.\\[1mm]
	Let $\bf{E}^n_h, \bf{H}^{n+\frac{1}{2}}_h$  be given at $\Gwh^{\e}$ and $\Gwh^{\h}$ respectively. \\[2mm]
	{\bf Step 1}: solve the following equations in $\intr{\Gwh^{\e}}$ with
	 $B^{E_s^*}=0$ for $s=x,y,z$: \\[2mm]
	$$
	\widetilde{\e}_h^{n+1}:=
	\left.
	\begin{pmatrix}
		\widetilde{E}_x^{n+1}\\
		\widetilde{E}_y^{n+1}\\
		\widetilde{E}_z^{n+1}
	\end{pmatrix}\right|_{\; \intr{\Gwh^{\e}}}^{\;}=
\left.
	\begin{pmatrix}
		E_x^n+\Delta \tau E_x^{*}\\
		E_y^n+\Delta \tau E_y^{*}\\
		E_y^n+\Delta \tau E_y^{*}
	\end{pmatrix}\right|_{\; \intr{\Gwh^{\e}}}^{\;}
	$$
	where 
	$$
	\underbrace{
	\begin{pmatrix}
		P_1^{E_x} & 0&0 \\
		0 & P_1^{E_y} &\\
		0&0&P_1^{E_z} 
	\end{pmatrix}
}_{:=P_1^\e}
	\begin{pmatrix}
		E_x^{*}\\
		E_y^{*} \\
		E_z^{*}
	\end{pmatrix}+\underbrace{B^{n+1}}_{=0}=Z
\left [ \left.
	\underbrace{
	\begin{pmatrix}
		P_2^{E_x} & 0&0 \\
		0 & P_2^{E_y} &\\
		0&0&P_2^{E_z} 
	\end{pmatrix}
}_{:=P_2^\e}
	\begin{pmatrix}
		0& -\delta_z & \delta _y\\
		\delta_z&0&-\delta_x\\
		-\delta_y&\delta_x&0
	\end{pmatrix}
	\begin{pmatrix}
		H_x^{n+\frac{1}{2}}\\
		H_y^{n+\frac{1}{2}}\\
		H_z^{n+\frac{1}{2}}
	\end{pmatrix}+P({\bf J})\right]\right|_{\; \intr{\Gwh^{\h}}}^{\;}.
	$$
	Extend $\widetilde{\e}_h^{n+1}$
to $\Gwh^\e$ using the boundary conditions $B^{n+1}=0$ and derive 
$\e_h^{n+1}$ in $\Gwh^\e$. 
	\\[2mm]
	{\bf Step 2}: solve $\bf{H}^{n+3/2}_h$ in $\intr\Gwh^\h$: \\[2mm]
	Consider some  boundary conditions $B^{n+3/2}$.
	\begin{equation}\label{eq:BH}
	\begin{pmatrix}
		B^{H_x}\\ B^{H_y}\\ B^{H_z}
	\end{pmatrix}
	=
	-\frac{1}{Z}
	\left[ \left.	
	\begin{pmatrix}
		0& -\delta_z & \delta _y\\
		\delta_z&0&-\delta_x\\
		-\delta_y&\delta_x&0\\
	\end{pmatrix}
	\begin{pmatrix}
		E_x^{n+1}\\
		E_y^{n+1}\\
		E_z^{n+1}
	\end{pmatrix}\right]\right|_{\; \partial{\Gwh^{\h}}}^{\;}
	\end{equation}
	(see Remark \ref{rem:expB}).
define
	$$
	\widetilde{\h}_h^{n+3/2}:=
	\left.
	\begin{pmatrix}
		\widetilde{H}_x^{n+3/2}\\
		\widetilde{H}_y^{n+3/2}\\
		\widetilde{H}_z^{n+3/2}
	\end{pmatrix}\right|_{\; \intr{\Gwh^{\h}}}^{\;}=
\left.
	\begin{pmatrix}
		H_x^{n+\frac{1}{2}}+\Delta \tau H_x^{*}\\
		H_y^{n+\frac{1}{2}}+\Delta \tau H_y^{*}\\
		H_y^{n+\frac{1}{2}}+\Delta \tau H_y^{*}
	\end{pmatrix}\right|_{\; \intr{\Gwh^{\h}}}^{\;}
	$$
	where 
	$$
	\underbrace{
	\begin{pmatrix}
		P_1^{H_x}  & 0&0 \\
		0 & 	P_1^{H_y}  &\\
		0&0&	P_1^{H_z} 
	\end{pmatrix}
}_{:=P_1^\h}
	\begin{pmatrix}
		H_x^{*}\\
		H_y^{*} \\
		H_z^{*}
	\end{pmatrix}+B^{n+3/2}=-\frac{1}{Z}
\left[ \left.
	\underbrace{
	\begin{pmatrix}
		P_2^{H_x} & 0&0 \\
		0 & P_2^{H_y} &\\
		0&0&P_2^{H_z} 
	\end{pmatrix}
}_{:=P_2^\h}
	\begin{pmatrix}
		0& -\delta_z & \delta _y\\
		\delta_z&0&-\delta_x\\
		-\delta_y&\delta_x&0\\
	\end{pmatrix}
	\begin{pmatrix}
		E_x^{n+1}\\
		E_y^{n+1}\\
		E_z^{n+1}
	\end{pmatrix}\right]\right|_{\; \intr{\Gwh^{\h}}}^{\;},
	$$
		Extend $\widetilde{\h}_h^{n+3/2}$ 
	to $\Gwh^\h$ by defining it to be 
	$$
		-\frac{1}{Z}
	\left[ 
	\begin{pmatrix}
		0& -\delta_z & \delta _y\\
		\delta_z&0&-\delta_x\\
		-\delta_y&\delta_x&0\\
	\end{pmatrix}
	\begin{pmatrix}
		E_x^{n+1}\\
		E_y^{n+1}\\
		E_z^{n+1}
	\end{pmatrix}\right]
	$$
	in both $\partial \Gwh^\h$ and $\partial (\intr{\Gwh^{\h}}$)
	and derive $\h_h^{n+3/2}$. 

\begin{rem}\label{rem:expB}


Consider the equation based  Taylor expansion
	$$
	\frac{\h^{n+3/2}-\h^{n+\frac{1}{2} } }{\Delta \tau}=
	\frac{\partial \h}{\partial t}+O(\Delta \tau ^2)=
	-\frac{1}{Z}	\begin{pmatrix}
		0& -\delta_z & \delta _y\\
		\delta_z&0&-\delta_x\\
		-\delta_y&\delta_x&0\\
	\end{pmatrix}
	\begin{pmatrix}
		E_x^{n+1}\\
		E_y^{n+1}\\
		E_z^{n+1}
	\end{pmatrix}+O(\Delta \tau^2+h^4).
	$$
	Hence the  boundary conditions \eqref{eq:BH} are 
 indeed consistent with the Taylor expansion of the equation.
\end{rem}
   
	\begin{rem}
	Approximation of the boundary conditions to order $\Delta \tau ^4$ is also possible as depicted in the example in section \ref{sec:TE}. However, we choose the boundary conditions to fit the stability analysis in the subsequent sections.
	\end{rem}

	


	

	\section{Energy estimates}
	The goal of the the current section is proving the following stability result.
	\begin{lemma}\label{lem:coer}
		For any $Z$ and smooth function $\J$ in $[0,1]^3\times [0,\infty)$, 
		$$
		r<\min \left \{  \frac{1}{\sqrt[3]{6}},\frac{2\cdot\min\{Z,Z^{-1}\}}
		{\|a^{-1}+a^{-t}\|\sqrt{3}}  \right \}
	$$
	implies stability.
 		\end{lemma}
 
 We assume during this section without loss of generality that $Z=1$ and $J=0$.
We use energy estimates in order to prove Lemma \ref{lem:coer}.

There are two main non-trivial difficulties we have to surpass:
 The first is the fact that the operators $a_s$ are not symmetric. We surpass this difficulty by showing that its corresponding  anti-symmetric parts are "small" enough (Lemma \ref{lem:antiestimates});
 the second difficulty comes from the boundary equations we have to impose for the elliptic equations   we solve for $\h$.
  We will show how the fact that  we impose specific boundary conditions  in both $\partial \Gwh^\h$ and $\partial (\intr{\Gwh^{\h}}$) enables  us to accomplish our estimates.  
 

%	\begin{lem}[Abel transformation]
%		Let $p\geq 1$ be integer and $\{a_k\}_{k=1}^{p}$,$\{b_k\}_{k=1}^{p}$ be two sequences. Then
%		$$
%		\sum_{k=1}^{p}a_kb_k=a_pB_p-\sum_{k=1}^{p-1}(a_{k+1}-a_k)B_k
%		$$
%		where 
%		$B_k:=\sum_{i=1}^{k}b_i$.
%	\end{lem}
\begin{lem}[\cite{Morton}]
Let $\{a_1\}_{k=0}^{p-1}$,$\{b_k\}_{k=0}^{p}$ be two sequences. Then
$$
\sum_{k=1}^{p}a_{k-1}(b_k-b_{k-1})=a_{p-1}b_p-a_{0}b_0-\sum_{k=1}^{p-1}(a_{k}-a_{k-1})b_k.
$$
\end{lem}



\begin{lemma}(cf. \cite[(37)]{sakka} )\label{lem:sym}
	Assume that $\e_h\in \Gwh^\e$ and $\h_h\in \Gwh^\h$, and
	$\bf{E}_h$ vanishing on $\partial \Gwh^{\bf{E}}$. Then,
	\begin{itemize}
		\item  
		$
		(\curl_h\e_h,\h_h)_{\Gwh^\h}=
		(\curl_h\h_h,\e_h)_{\Gwh^\e}.
		$\\[1mm]
		\item $(\curl _h\e_h,\h_h)_{\Gwh^\h}\leq
		  \frac{2\sqrt{3}}{h}\|\e_h\|_{\Gwh^\e}
		\|\h_h\|_{\Gwh^\h}
		$.

	\end{itemize}

\end{lemma}

In the following Lemma we estimate the anti-symmetric part of the operator $a_s^{-1}$, where $s=x,y,z$.
    We denote by $\frac{a_s+a_s^t}{2}$ and $\frac{a_s-a_s^t}{2}$ the symmetric and the anti-symmetric decomposition of $a_s$ respectively.
\begin{lem}\label{lem:antiestimates}
	There exists $C>0$, not depending on $h$, such that $$\|<a_s^{-1}-a_s^{-t}>\curl_h\|\leq C.$$
\end{lem}
\begin{proof}
	Recall that the matrix  $a_s $ in Appendix \ref{appendix} is non-singular,  $a_s^{-1}-a_s^{-t}$ is anti-symmetric, and $\|a_s\|$  is bounded from above and below for all $s=x,y,z$ uniformly in $h$. Therefore it is enough to show that $a_s^{-1}-a_s^{-t}$ is of constant rank which do not depend on $h$. This follows  first by the following  observations: 
	$\mathrm{rank}(a_s-a_s^t)\leq 8$ (for all $N$); For any non-singular matrix $A$ and any $v\in \mathrm{ker}(A-A^t)$
	$$
	Av=A^tv \Rightarrow v=A^{-1}A^{t}v=A^{-t}A^{t}v\Rightarrow
	\mathrm{rank}(A^{-1}-A^{-t})\leq 	\mathrm{rank}(A-A^t).
	$$
	Assume without loss of generality that $a_s=a_x$. 
	We diagonalize the hermitian matrix $\sqrt{-1}(a^{-1}-a^{-t})$.
	Consider  two grid functions $U_{i,j,k}, V_{i,j,k}$
	such that for any $j,k$ $V_{,j,k}$ and $U_{+1/2,j,k},U_{-1/2,j,k}$ are orthonormal (complex) eigenvectors corresponding to  eigenvalues $\lambda^{i,j} $ and of unit norm with respect to $x$ coordinate. Then  
	\begin{align*}
		&| (<a_x^{-1}-a_x^{-t}>D_x U,V)_{\Gwh^\e}|= (\sqrt{-1}<a_x^{-1}-a_x^{-t}>D_x U,V)_{\Gwh^\e}|
\leq \\&
	h^2\sum_k\sum_j\sum_i \sum_{l} (\sqrt{-1}a_{il}^{-1}-\sqrt{-1}a_{il}^{-t})\frac{U(l+n/2,j,k)-U(l-n/2,j,k)}{h}V_{i,j,k}\\&
		=
	h^2\sum_j\sum_k\lambda^{i,j} \leq \|a^{-1}-a^{-t}\|=\\&
	\|a^{-1}-a^{-t}\|\sum_{i,j,k}(U(l+n/2,j,k)-U(l-n/2,j,k))V_{i,j,k}\leq 
		2\|a^{-1}-a^{-t}\|\|U\| \|V\|.
	 	\end{align*}
 Since the $\mathrm{rank}$ of $a^{-1}-a^{-t}$ does not depend on the mesh size there exists $C$ such that for all $U,V$, $$(<a_x^{-1}-a_x^{-t}>D_x U,V)_{\Gwh^\e}\leq2 C\|a^{-1}-a^{-t}\|\|U\|\|V\|.$$
 
 Another proof can be obtained by considering  orthogonal basis for $\mathrm{ker}(a^{-1}-a^{-t})$
\end{proof}

		Next, we extend the operator $P_2$ and $P_1$ symmetrically  to $\Gwh^{\e}$ and 
$\Gwh^{\h}$ and denote them $P_{1,ext}$, $P_{2,ext}$.
\begin{defi}

	We define the following quantities.
	\begin{align*}
		&
		\mathcal{E}_1^{n}:=
		(P_1\widetilde{\e}_h^{n},\widetilde{\e}_h^{n})_{\intr{\Gwh^\e}}+
		%	-\Delta \tau\frac{1}{2} (P_2<a^{-1}+a^{-t},\curl_h>\h_h^{n+1/2},\e_h^n)+\\&
		(P_1\widetilde{\h}_h^{n+1/2},\widetilde{\h}_h^{n+1/2})_{\intr{\intr{\Gwh^\h}}}, \\&
		\mathcal{E}_2^{n}:=-\frac{\Delta \tau}{2}(P_{2,ext}<a^{-1}+a^{-t}>\curl_h \e^{n},\h^{n+1/2})_{\Gwh^\h}\\&
		\mathcal{E}_3^{n}:=(P_{2}\h^{n+1/2},\h^{n+1/2})_{\partial \Gwh^\h\cup \partial \intr{\intr{\Gwh^\h}}}\\&
		\mathcal{E}_4^{n}:=\mathcal{E}^n_1+\mathcal{E}^n_2-\mathcal{E}^n_3.
	\end{align*}
\end{defi}
\begin{lem}\label{lem:first}
	Assume that 
	$$
	r<\min \left \{  \frac{1}{\sqrt[3]{6}},\frac{2}{\|a^{-1}+a^{-t}\|\sqrt{3}}  \right \}
	$$
	There there exists $C>0$ such that  
	$\mathcal{E}_4^n\geq C(\|\e^n\|^2+\|\h^n\|^2) $.
\end{lem}

\begin{proof}
Let $r<\frac{1}{\sqrt[3]{6}}$.
Then $$\mathcal{E}_1^n-\mathcal{E}_3^n\geq
\frac{24}{\Delta \tau^2}\left ( \|\e_h^n\|_{\Gwh^\e}+\|\h_h^{n+1/2}\|_{\Gwh^\h}\right)$$
By Young's inequality,
$$
\mathcal{E}_2^n\leq \frac{24}{\Delta \tau^2}\frac{r\sqrt{3}}{2}\|a^{-1}+a^{-t}\|(\|\e_h^n\|_{\Gwh^\e}+\|\h_h^{n+1/2}\|_{\Gwh^\h}).
$$
Therefore for $r$ small enough
 $\mathcal{E}_4^n\geq\frac{24}{\Delta \tau^2} (1-r\frac{\|a^{-1}+a^{-t}\|\sqrt{3}}{2})\left ( \|\e_h^n\|_{\Gwh^\e}+\|\h_h^{n+1/2}\|_{\Gwh^\h}\right)$.
\end{proof}
\begin{remark}
	If $a$ is the identity operator, then 
	$\min \left \{  \frac{1}{\sqrt[3]{6}},\frac{2}{\|a^{-1}+a^{-t}\|\sqrt{3}}  \right \}=
	\frac{1}{\sqrt{3}},
	$
	which is the stability condition for the classical Yee scheme.
\end{remark}
\begin{lem}\label{lem:sec} 
	We have
	$$\mathcal{E}_4^n-
\mathcal{E}_4^{n+1}=
\mathbf{term}
$$
where 
$$
\mathbf{term}\leq C \Delta \tau(\mathcal{E}_4^{n+1}+\mathcal{E}_4^{n}).
$$
and $C$ does not depend on $h$.
\end{lem}
\begin{proof}
	
	We write the following scheme equalities in the space $\intr{\intr\Gwh}$.
	
	\begin{align}
		P_1(\widetilde{\e}_h^{n+1} -\widetilde{\e}^{n})=
		\Delta \tau P_2 \acurl \h_h^{n+1/2} \quad \mathrm{in} \  \intr{\Gwh^\e}
	\end{align}
	\begin{align}
		P_1(\widetilde{\h}_h^{n+3/2} -\widetilde{\h}^{n+1/2})
		=
		-\Delta \tau P_2 \acurl \e_h^{n+1}  \quad \mathrm{in} \  \intr{\intr{\Gwh^\h}}.
	\end{align}
{ \bf
We restrict ourselves to $ \intr{\intr{\Gwh^\h}}$ to avoid the boundary term $B^{n+3/2}$}.
	

	
	Next, we take inner products of the scheme with $\widetilde{\e}_h^{n+1}+\widetilde{\e}_h^n$,
	and with 
	$\widetilde{\h}_h^{n+3/2}+\widetilde{\h}_h^{n+1/2}$ such that 
	$\widetilde{\h}_h^{n+3/2}+\widetilde{\h}_h^{n+1/2}$ is orthogonal to the boundary term $B^{n+3/2}$.
We have
	\begin{align*}
		&
		(P_1(\widetilde{\e}^{n+1}_h-\widetilde{\e}^{n}_h),\widetilde{\e}^{n+1}_h+\widetilde{\e}^{n}_h)_{\intr{\Gwh^\e}}+
		(P_1(\widetilde{\h}^{n+3/2}_h-\widetilde{\h}^{n+1/2}_h),\widetilde{\h}^{n+3/2}_h+\widetilde{\h}^{n+1/2}_h)_{\intr{\intr{\Gwh^\h}}}=\\&
		=\mathcal{E}_1^{n+1}-\mathcal{E}_1^{n}.
	\end{align*}
	Next we estimate
	\begin{align*}
		&
		(\frac{1}{2}\Delta \tau P_2<a^{-1}+a^{-t},\curl_h>\h^{n+1/2},\widetilde{\e}^{n+1}+\widetilde{\e}^{n})_{ \intr{\Gwh^\e}}=\\&
		(\frac{1}{2}\Delta \tau P_{2,ext}<a^{-1}+a^{-t},\curl_h>(\e^{n+1}+\e^{n}),\h^{n+1/2})_{ {\Gwh^\e}}
	\end{align*}
	Similarly,
	\begin{align*}
		&
		(\frac{1}{2}\Delta \tau P_2<a^{-1}+a^{-t},\curl_h>\e^{n+1},\widetilde{\h}^{h+3/2}+\widetilde{\h}^{n+1/2})_{\intr{\intr{\Gwh^\h}}}=\\&
		(\frac{1}{2}\Delta \tau P_{2,ext}<a^{-1}+a^{-t},\curl_h>\e^{n+1},\h^{h+3/2}+\h^{n+1/2})_{{\Gw^\h}}
		\\&
		-(\frac{1}{2}\Delta \tau P_{2,ext}<a^{-1}+a^{-t},\curl_h>\e^{n+1},\h^{h+3/2}+\h^{n+1/2})_{\partial{\Gwh^\h}\cup \partial \intr{\Gwh^\h}}=\\&
		(\frac{1}{2}\Delta \tau P_{2,ext}<a^{-1}+a^{-t},\curl_h>(\h^{h+3/2}+\h^{n+1/2}),\e^{n+1})_{{{\Gw^\e}}}
		\\&
		-(\frac{1}{2}\Delta \tau P_{2}<a^{-1}+a^{-t},\curl_h>\e^{n+1},\h^{n+3/2}+\h^{n+1/2})_{\partial{\Gwh^\h}\cup \partial \intr{\Gwh^\h}}.
	\end{align*}
	Recall that we chose our boundary conditions such that 
	the last term equals $$\mathcal{E}_3^{n+1}-\mathcal{E}_3^{n}+
	\mathbf{term}$$ where $\mathbf{term}$ include the anti-symmetric part.
	Together with Lemma \ref{lem:antiestimates} and Young's inequality we have the following:
		$$\mathcal{E}_4^n-
	\mathcal{E}_4^{n+1}=
	\mathbf{term}
		$$
		where 
		$$
		\mathbf{term}\leq C \Delta \tau( \sum_{i=1}^3\mathcal{E}_i^n+
		\sum_{i=1}^3\mathcal{E}_i^{n+1}).
		$$
\end{proof}
Lemmas \ref{lem:first}, \ref{sec:TE} imply that if $\Delta \tau n\leq T$
then 
$$
\mathcal{E}_4^{n}\leq C \mathrm{e}^{T}\mathcal{E}_4^{0},
$$
and thus Lemma \ref{lem:coer} is proved (cf. \cite[chapter 5]{GKO}).
	
	
	
	\section{Example: Transverse magnetic waves  in $[0,1]^3$}\label{sec:TE}
	Assuming that $E_x=E_y=H_z=\vec{J}=0$ we can reduce Maxwell equations to a two-dimensional problem for $E_z(t,x,y), H_x(t,x,y), H_y(t,x,y)$ where  $(x,y)\in[0,1]^2$, and
	$x_0=y_0=0$, and $x_{N-1}=y_{N-1}=0$.
	The rescaled equations are therefore 
	
	\begin{enumerate}
		\item  $ \frac{\partial E_z}{\partial \tau }=Z\left (
		\frac{\partial H_y}{\partial x}-\frac{\partial H_x}{\partial y}
		\right)$
		\item 	  $ \frac{\partial H_x}{\partial \tau }=-\frac{1}{Z}\frac{\partial E_z}{\partial y}$
		\item 	  $ \frac{\partial H_y}{\partial \tau }=\frac{1}{Z}\frac{\partial E_z}{\partial x}$,
		
	\end{enumerate}
	and the scheme  reads as the following consecutive steps.
	\begin{enumerate}
		\item  $ E_z^{n+1}=E_z^n(i,j)+Z\Delta \tau \cdot 
		\left(\frac{P_1^{E_z}}{P_2^{E_z}}\right)^{-1}
		\left (\frac{\partial H_y}{\partial x}-
		\frac{\partial H_x}{\partial y}
		\right)^{n+\frac{1}{2}}$\\[1mm]
		\item $ H_x^{n+3/2}=H_x^{n+\frac{1}{2}}+\frac{\Delta \tau}{Z} \cdot  \left(\frac{P_1^{H_x}}{P_2^{H_x}}\right)^{-1}\left (-
		\frac{\partial E_z}{\partial y}
		\right)^{n+1} $\\[1mm]
		\item $ H_y^{n+3/2}=H_y^{n+\frac{1}{2}}+\frac{\Delta \tau}{Z} \cdot  \left(\frac{P_1^{H_y}}{P_2^{H_y}}\right)^{-1}\left (
		\frac{\partial E_z}{\partial x}
		\right)^{n+1} $.
	\end{enumerate}
	\begin{figure}[!t]
		\centering
		\includegraphics[scale=0.7]{figures/Ez.eps}
		\caption{
			The numerical domain for step 1.
			Squares denote boundary points. x denotes interior points of the numerical domain.  The points where $H_x$ and $H_y$ are evaluated (little blue and red dots resp.) are shown for reference.}
		\label{fig:E}
		
	\end{figure}
	
	As mentioned before, these  elliptic equations  can be solved  to fourth order   if the boundary conditions of the solutions and of the non-homogeneous term are known to fourth order \cite{singer_turkel}.
	Let us examine each step in the scheme separately:\\[1mm]
	{\bf Step 1 } (See Figure \ref{fig:E}):  	$\Gw^{E_z}=\{(x_i,y_j)\}_{i,j\in [N]}$;
% boundary conditions :  the boundary values of $\delta_{\tau} E_z$ are given explicitly (=0) from the boundary conditions $\vec{\nu}\times \vec{E}=0$; non-homogeneous term:
%	$\left (\frac{\partial H_y}{\partial x}-\frac{\partial H_x}{\partial y}\right )^{n+\frac{1}{2}}$ can be estimated using Pad\'e approximation (see  Appendix \ref{appendix}) at all points 
%	$(x_i,y_j)$
%	which do not belong to $\partial [0,1]^2$.  However, at these boundary points, the equations readily imply that  
%	$\left (\frac{\partial H_y}{\partial x}-\frac{\partial H_x}{\partial y}\right )^{n+\frac{1}{2}}=0$ on $\partial [0,1]^2$.
\\[1mm]
	{\bf Step 2} (See Figure \ref{fig:Hx}): 
 $\Gw^{H_x}=\{(x_i,y_{j+\frac{1}{2}})\}_{i\in [N],j\in [N-1]}$; 
	non-homogeneous term:  
	$\left (\frac{E_z}{\partial y}\right)^{n+1} $
	can be approximated  using Pad\'e approximation  in Appendix \ref{appendix} at all discretization points;
	boundary conditions:
	we  estimate 
	$\frac{H_x^{n+3/2}-H_x^{n+\frac{1}{2}}}{\Delta \tau}$ on the boundary as follows.
	The equation  
	$$
	\frac{\partial H_x}{\partial \tau}=-\frac{1}{Z}\frac{\partial E_z}{\partial y}
	$$
	implies that $H_x(0,y)$ and $H_x(1,y)$ do not depend on $\tau$, that is 
	$$\frac{H_x^{n+3/2}-H_x^{n+\frac{1}{2}}}{\Delta \tau}=0$$ if $x=0$ or $x=1$.
	On the remaining part of the boundary ($y=0,1$)  we use Taylor series:
	$$
	\frac{	H_x^{n+3/2}-H_x^{n+\frac{1}{2}}}{\Delta \tau}=
	\left(\frac{\partial H_x}{\partial \tau}\right)^{n+1}+
	\frac{\Delta \tau^2}{24}\left(\frac{\partial^3 H_x}{\partial \tau^3}\right)^{n+1}+O(\Delta \tau^4).
	$$
	%$$
	%=\left(\frac{\partial H_x}{\partial t}\right)^{n+1}\left(1+
	%\frac{\Delta t^2}{24}\cdot 
	%\left (\frac{\partial^2 H_x}{\partial t^2}\right)^{n+1}+
	%O(\Delta t^4)
	%\right)
	%$$
	Recall that
	$\left(\frac{\partial H_x}{\partial \tau}\right)^{n+1}=-\frac{1}{Z}\left(\frac{\partial E_z}{\partial y}\right)^{n+1}$ has been already approximated to fourth order. 
	If one uses just the approximation 
	$$
	\frac{	H_x^{n+3/2}-H_x^{n+\frac{1}{2}}}{\Delta \tau}=
	\left(\frac{\partial H_x}{\partial \tau}\right)^{n+1}
	$$
	then the boundary conditions are of order $h^4+\Delta \tau^2$.
	
	The remaining term 
	can be  approximated to order $\Delta \tau^2 h^2$ as follows.
	The equations imply that   $\frac{\partial^2E_z}{\partial \tau^2}=\Delta E_z$, and therefore
	$$
	\frac{\partial^3 H_x}{\partial \tau^3}=
	-\frac{1}{Z}\Delta \frac{\partial E_z }{\partial y}.
	$$
	The Laplacian of $\frac{\partial E_z }{\partial y}$ can be estimated at the boundary points  to order $h^2$ using central and one-sided schemes for second-order derivatives.
	In such a case the boundary conditions are of order $h^4+\Delta \tau^2h^2.$
	The numerical simulations   presented in  Table \ref{table:conv_rates} show the affect of the boundary conditions accuracy on the convergence rates.\\[1mm]
	{\bf Step 3} : \\ $\Gw^{H_y}=\{(x_{i+\frac{1}{2}},y_{j})\}_{i\in [N-1],j\in [N]}$; the boundary terms and the boundary conditions are treated by a similar way to step 2.
	
	\begin{figure}[!t]
		\centering
		\begin{subfigure}[h]{0.4\textwidth}
			\includegraphics[scale=0.45]{figures/Hx.eps}
		\end{subfigure}
		\begin{subfigure}[h]{0.4\textwidth}
			\includegraphics[scale=0.45]{figures/Hy.eps}
		\end{subfigure}
		\caption{The numerical domains for steps 2,3.
			Squares denote $\partial \Gw^{H_x}$ (left)  and $\partial \Gw^{H_y}$. "x" denotes $\intr{\Gw^{H_x}}$ (left) and $\intr{\Gw^{H_y}}$ . $\Gw^{E_z}$ (little black dots) is shown for reference.}
		\label{fig:Hx}			\end{figure}
	\subsection{Numerical simulations}
	We test analytical solutions in the case $Z=1$,  
	$(k_x,k_y)=(4,3)$ and $\omega:=\sqrt{k_x^2+k_y^2}$.
	Namely, 
	\begin{align*}
		&
		E_z=\cos(\omega \tau)
		\sin{\left( \pi  k_x x\right) } \sin{\left( \pi  k_y y\right) }
		\\ &
		H_x=-\frac{\sin( \omega \tau)}{\omega}
		\pi k_y \sin( \pi  k_x x)
		\cos{\left( \pi  k_y y\right) } \\&
		H_y=\frac{\sin\left( \omega \tau\right) }{\omega} \pi  k_x \cos{\left( \pi  k_x x\right) } \sin{\left( \pi  k_y y\right) }. \\&
	\end{align*}
	
	
	We use the mean absolute error 
	$$
	\frac{1}{N_{\tau}\cdot N^2}\sum_{i,j,n=0}^{N,N,N_{\tau}}\left | F^n_{\mathrm{numer.}}(i,j)-F_{\mathrm{true}}^n(i,j) \right|
	$$
	$(\vec{F}=(E_z,H_x,H_y))$ to calculate the (log-)convergence rates of our schemes.
	%	\begin{table} [h!]
		%	\centering
		%	\begin{tabular}{|p{0.7cm}|p{0.7cm}|p{2cm}|p{2cm}| p{2cm}|}
			%		\hline
			%$h$ & $\mathrm{CFL}$ &$\Delta \tau^2+h^4$&$\Delta \tau^2h^2+h^4$& analytic
			%		\\ [0.5ex] 
			%		\hline 
			%$\frac{1}{20}$ & 0.5& & & \\
			%$\frac{1}{25}$ & 0.5 &3.74 &5.51&5.27\\
			%$\frac{1}{30}$ & 0.5 & 3.50 &5.55& 5.38 \\
			%$\frac{1}{35}$ & 0.5 &3.38 & 5.57&5.30\\
			%$\frac{1}{40}$ & 0.5& 3.31 &5.55 &5.22\\
			%\hline 
			%	\end{tabular}
		%	\caption{ Converge rates with several types of boundary conditions for $\delta_\tau \vec{H}$ in steps 2 and 3:	 
			%	Here $\Delta \tau=\frac{h}{2}$ where $h=\frac{1}{20},\frac{1}{25},\frac{1}{30},
			%	\frac{1}{35}, \frac{1}{40}
			%	$
			%	and final time $T=1$.}
		%	\label{table:conv_rates}
		
		
		%\end{table}
		\begin{table} [h!]
			\centering
			\begin{tabular}{|p{0.7cm}|p{0.7cm}|p{2cm}|p{2cm}|}
				\hline
				$h$ & $\mathrm{CFL}$ &$\Delta \tau^2+h^4$&$\Delta \tau^2h^2+h^4$
				\\ [0.5ex] 
				\hline 
				$\frac{1}{16}$ & 0.5& &  \\[0.5mm]
				$\frac{1}{32}$ & 0.5 &3.70 &5.45\\[0.5mm]
				$\frac{1}{64}$ & 0.5 & 3.21 &5.23 \\[0.5mm]
				$\frac{1}{128}$ & 0.5 &3.03 & 3.98\\[0.5mm]
				$\frac{1}{256}$ & 0.5& 2.99 &3.93 \\[0.5mm]
				\hline 
			\end{tabular}
			\caption{ Converge rates with several types of boundary conditions for $\delta_\tau \vec{H}$ in steps 2 and 3:	 
				Here $\Delta \tau=\frac{h}{2}$ where $h=\frac{1}{16},\frac{1}{32},\frac{1}{64},
				\frac{1}{128}, \frac{1}{256}
				$
				and final time $T=1$.}
			\label{table:conv_rates}
			
			
		\end{table}
		\begin{table} [h!]
			\centering
			\begin{tabular}{|p{0.7cm}|p{0.7cm}|p{2cm}| |p{4cm}|}
				\hline
				$h$ & $\mathrm{CFL}$ &error& convergence rate
				\\ [0.5ex] 
				\hline 
				$\frac{1}{16}$ & 0.5& 2.9e-3&  \\[0.5mm]
				$\frac{1}{32}$ & 0.5 &6.7e-5 &5.45\\[0.5mm]
				$\frac{1}{64}$ & 0.5 & 1.8e-6 &5.23 \\[0.5mm]
				$\frac{1}{128}$ & 0.5 &1.1e-7 & 3.98\\[0.5mm]
				$\frac{1}{256}$ & 0.5& 7.5e-9 &3.93 \\[0.5mm]
				\hline \hline
				$\frac{1}{16}$ & 0.5& 0.38&  \\[0.5mm]
				$\frac{1}{32}$ & 0.5 &0.22 &0.75\\[0.5mm]
				$\frac{1}{64}$ & 0.5 & 5.2e-3 &5.4 \\[0.5mm]
				$\frac{1}{128}$ & 0.5 &2.2e-4 & 4.52\\[0.5mm]
				$\frac{1}{256}$ & 0.5& 1.6e-5 &3.822 \\[0.5mm]
				\hline
			\end{tabular}
			\caption{ Converge rates with $k_x=4,k_y=3$ (upper table)
				and  $k_x=17,k_y=18$.
				Here $\Delta \tau=\frac{h}{2}$ where $h=\frac{1}{16},\frac{1}{32},\frac{1}{64},
				\frac{1}{128}, \frac{1}{256}
				$
				and final time $T=1$.}
			\label{table:conv_rates_2}
			
			
		\end{table}
		\subsection{Comparison with non-compact fourth order scheme and with data-driven scheme (AI(2,3)) trained on high wave-numbers}
		\begin{table} [h!]
			\centering
			\begin{tabular}{|p{0.7cm}|p{0.7cm}|p{4cm}|p{4cm}|p{4cm}|}
				\hline
				$h$ & $\mathrm{CFL}$ &compact-4th& AI(2,3)&non-compact-4th
				\\ [0.5ex] 
				\hline 
				$\frac{1}{16}$ & 0.5& 6.9e-5&  6e-5&8.7e-5 \\[0.5mm]
				$\frac{1}{32}$ & 0.5 &1.5e-6 &6.9e-6&1.18e-5 \\[0.5mm]
				$\frac{1}{64}$ & 0.5 & 6.8e-8 &8.2e-7& 1.5e-6 \\[0.5mm]
				$\frac{1}{128}$ & 0.5 &4.9e-9 & 1e-7&1.9e-7 \\[0.5mm]
				$\frac{1}{256}$ & 0.5& 3.7e-10 &1.2e-8&2.4e-8 \\[0.5mm]
				\hline \hline
				$\frac{1}{16}$ & 0.5& 2.9e-3&  2.6e-4&8.1e-4 \\[0.5mm]
				$\frac{1}{32}$ & 0.5 &6.7e-5 &2.2e-5&1.1e-4 \\[0.5mm]
				$\frac{1}{64}$ & 0.5 & 1.8e-6 &1.8e-6& 1.4e-5 \\[0.5mm]
				$\frac{1}{128}$ & 0.5 &1.1e-7 & 1.8e-7&1.8e-6 \\[0.5mm]
				$\frac{1}{256}$ & 0.5& 7.5e-9 &1.9e-8&2.2e-7 \\[0.5mm]
				\hline \hline
				$\frac{1}{16}$ & 0.5& 0.38& 3.4e-3 &4.4e-3\\[0.5mm]
				$\frac{1}{32}$ & 0.5 &0.22 &2.9e-3&3.4e-3 \\[0.5mm]
				$\frac{1}{64}$ & 0.5 & 5.2e-3 &1e-4& 1.7e-3\\[0.5mm]
				$\frac{1}{128}$ & 0.5 &2.2e-4 & 2.84e-6&2.8e-4\\[0.5mm]
				$\frac{1}{256}$ & 0.5& 1.6e-5 &1.02e-6& 3.5e-5\\[0.5mm]
				\hline
			\end{tabular}
			\caption{ Errors for solutions  with wave-numbers $k_x=1,k_y=2$ (upper table), $k_x=4,k_y=3$ (middle table),
				and  $k_x=17,k_y=18$.
				Here $\Delta \tau=\frac{h}{2}$ where $h=\frac{1}{16},\frac{1}{32},\frac{1}{64},
				\frac{1}{128}, \frac{1}{256}
				$
				and final time $T=1$.}
			\label{table:conv_rates_3}
		\end{table}

		%\section{Convergence rates with boundary conditions for $H$ of order 
			%	$dt^2+h^4$}
		%We test analytical solutions in the case $c=1$,  such that 
		%$(k_x,k_y)=(4,3)$ and $\Omega=\sqrt{k_x^2+k_y^2}$.
		%We take $dt=\frac{h}{2}$ where $h=\frac{1}{20},\frac{1}{25},\frac{1}{30},
		%\frac{1}{35}, \frac{1}{40}$ from time 0 to time 1.
		%We consider the mean absolute error, that is 
		%$$
		%\frac{1}{N_t\cdot N^2}\sum_{i,j,n=0}^{N,N,N_t}\left | F^n(i,j)-F_{\mathrm{true}}^n(i,j) \right|
		%$$
		%$(\vec{F}=(E_z,H_x,H_y))$
		%to calculate the convergence rates as a function of $1/h$:
		%$$
		%(3.02, 3.15, 3.14,  3.15)
		%$$
		
		%	\begin{table} [h!]
			%	\centering
			%	\begin{tabular}{|p{0.7cm}|p{0.7cm}|p{0.7cm}| p{5cm}|p{5cm}|}
				%		\hline
				%		$N$& $N_t$ & $T$ &b.c for $H$: $O(dt^2+h^2)$& 
				%		b.c for $H$: $O(dt^2+h^4)$\\
				%		
				%		
				%
				%		
				%		
				%		
				%		\hline
				%	\end{tabular}
			%	\caption{Convergence rates
				%	}
			%	\label{table:tab3}
			%\end{table}
			\appendix
			\section{}\label{appendix}
			Assume that $f(x)$ is known at N points $x_0,x_1, ..,x_{N-1}$
			and we want to estimate to fourth order $f'(x)$ at N-1 points
			$x_{\frac{1}{2}},..,x_{N-3/2}$. This can be done  by solving the system of equations
			\begin{equation}\label{eq:lhs}
				\frac{1}{24}
				\begin{pmatrix}
					26     & -5     & 4      & -1     & 0      & \dots  & 0      \\
					1      & 22     & 1      & 0      & 0      & \dots  & 0      \\
					0      & 1      & 22     & 1      & 0      & \dots  & 0      \\
					\vdots & \ddots & \ddots & \ddots & \ddots & \ddots & \vdots \\
					0      & 0      & \dots  & 1      & 22     & 1      & 0      \\
					0      & 0      & \dots  & 0      & 1      & 22     & 1      \\
					0      & 0      & \dots  & -1     & 4      & -5     & 26
				\end{pmatrix}
				\begin{pmatrix}
					f'(x_{\frac{1}{2}}) \\
					f'(x_{3/2}) \\
					\cdots \\
					\cdots\\
					\cdots \\
					\cdots \\
					f'(x_{N-3/2})
				\end{pmatrix}=
				\frac{1}{\Delta x}
				\begin{pmatrix}
					f(x_{1})-f(x_0)  \\
					\cdots \\
					\cdots\\
					\cdots \\
					\cdots \\
					\cdots \\
					f(x_{N-1)}-f(x_{N-2})
				\end{pmatrix}.
			\end{equation}
		The matrix operator in the left hand side of \eqref{eq:lhs} will be denoted by $a$.
%		If one wants a symmetric operator, then one can redefine the system with compromising the accuracy on the boundary points.
%		\begin{equation}\label{eq:lhs2}
%			\frac{1}{24}
%			\begin{pmatrix}
%				24    & 0    & 0      & 0     & 0      & \dots  & 0      \\
%				1      & 22     & 1      & 0      & 0      & \dots  & 0      \\
%				0      & 1      & 22     & 1      & 0      & \dots  & 0      \\
%				\vdots & \ddots & \ddots & \ddots & \ddots & \ddots & \vdots \\
%				0      & 0      & \dots  & 1      & 22     & 1      & 0      \\
%				0      & 0      & \dots  & 0      & 1      & 22     & 1      \\
%				0      & 0      & \dots  & 0     & 0      & 0     & 24
%			\end{pmatrix}
%			\begin{pmatrix}
%				f'(x_{\frac{1}{2}}) \\
%				f'(x_{3/2}) \\
%				\cdots \\
%				\cdots\\
%				\cdots \\
%				\cdots \\
%				f'(x_{N-3/2})
%			\end{pmatrix}=
%			\frac{1}{\Delta x}
%			\begin{pmatrix}
%				f(x_{1})-f(x_0)  \\
%				\cdots \\
%				\cdots\\
%				\cdots \\
%				\cdots \\
%				\cdots \\
%				f(x_{N-1)}-f(x_{N-2})
%			\end{pmatrix}.
%		\end{equation}

			%By Taylor approximation:
			%$$
			%\frac{f(x+h/2)-f(x-h/2)}{h}=f'(x)+\frac{f'''(x)h^2}{24}+O(h^4)
			%$$
			%$$=
			%f'(x)+\frac{1}{24}(f'(x+h)-2f'(x+h)+f'(x-h))+O(h^4)
			%$$
			\section{}\label{appendxib}
			In the current appendix we develop the compact numerical scheme.
			We do so in a more general case  for which $\varepsilon$ and $\mu$ are not necessarily constants.
			 
				We first achieve fourth order accuracy in time using a Taylor expansion:
			\begin{align*}
				\left (\frac{\partial D_z}{\partial t} \right)^{n+\frac{1}{2}} &= \frac{D_z^{n+1} - D_z^{n}}{\Delta t} - \frac{(\Delta t^2)}{24} \frac{\partial D^3_z}{\partial t^3} + O(\Delta t)^4 \\
				&= \frac{D_z^{n+1} - D_z^{n}}{\Delta t} - \frac{(\Delta t^2)}{24} \partial_{tt} \left(\frac{\partial H_y}{\partial x}
				- \frac{\partial H_x}{\partial y} -  J_z \right)
				+ O(\Delta t)^4
			\end{align*}
			We now use the relation $H \!=\! \frac{1}{\mu} B$. For simplicity we define
			\begin{equation}
				\label{Dhat}
				\delta_t D_z: = \frac{D_z^{n+1} - D_z^{n}}{\Delta t} .
			\end{equation}
			We then get
			\begin{align*}
				\left (\frac{\partial D_z}{\partial t} \right)^{n+\frac{1}{2}}  &= \delta_t D_z - \frac{\Delta t^2}{24} \partial_{tt} \left(\frac{\partial {B_y \over \mu}}{\partial x }
				- \frac{\partial{B_x \over \mu}}{\partial y} - J_z \right) + O(\Delta t)^4 \\
				&= \delta_t D_z - \frac{\Delta t^2}{24} \frac{\partial}{\partial t} \left(\frac{\partial^2 {B_y \over \mu}}{\partial x \partial t}
				- \frac{\partial^2 {B_x \over \mu}}{\partial y \partial t} - \frac{\partial J_z}{\partial t} \right) + O(\Delta t)^4.
			\end{align*}
			Recall that 
			
			$$
			\frac{\partial B_y}{\partial t}=\frac{\partial E_z}{\partial x}-\frac{\partial E_x}{\partial z},\qquad
			\frac{\partial B_x}{\partial t}=\frac{\partial E_y}{\partial z}-\frac{\partial E_z}{\partial y}
			$$
			and since $\mu$ does not depend on $t$,
			$$
			\frac{\partial (B_y/\mu)}{\partial t}=
			\frac{1}{\mu}\left (
			\frac{\partial E_z}{\partial x}-\frac{\partial E_x}{\partial z}
			\right), \qquad
			\frac{\partial (B_x/\mu)}{\partial t}=
			\frac{1}{\mu}\left (
			\frac{\partial E_y}{\partial z}-\frac{\partial E_z}{\partial y}
			\right) .
			$$
			
			Hence
			$$
			\left(\frac{\partial^2 {B_y \over \mu}}{\partial x \partial t}
			- \frac{\partial^2 {B_x \over \mu}}{\partial y \partial t}  \right)=
			\left (
			\frac{\partial}{\partial x} \frac{1}{\mu}\left (
			\frac{\partial E_z}{\partial x}-\frac{\partial E_x}{\partial z}
			\right)-\frac{\partial }{\partial y} \frac{1}{\mu}\left (
			\frac{\partial E_y}{\partial z}-\frac{\partial E_z}{\partial y}
			\right) 
			\right)
			$$
			\begin{equation}\label{eq:mu_diff}
				=\frac{1}{\mu}
				\left(
				\frac{\partial^2 E_z}{\partial x^2}
				+\frac{\partial^2 E_z}{\partial y^2}
				-\frac{\partial^2 E_x}{\partial x\partial z}
				-\frac{\partial^2 E_y}{\partial y\partial z}
				\right)+
				\frac{\partial (1/\mu)}{\partial x}\left ( \frac{\partial E_z}{\partial x}-\frac{\partial E_x}{\partial z}\right)
				-
				\frac{\partial (1/\mu)}{\partial y}\left ( \frac{\partial E_y}{\partial z}-\frac{\partial E_z}{\partial y}\right).
			\end{equation}
			After adding and subtracting $\frac{\partial^2 E_z  }{\partial z^2}$
			in the first parenthesis in \eqref{eq:mu_diff}, and adding and subtracting
			$\frac{\partial (1/\mu)}{\partial z}\frac{\partial E_z}{\partial z}$
			we obtain that  \eqref{eq:mu_diff} equals to
			$$
			div(\mu^{-1}\nabla E_z)-div(\mu^{-1}\frac{\partial \vec{E}}{\partial z}).
			$$
			This yields
			\begin{align*}
				&
				\left ( \frac{\partial H_y}{\partial x}-
				\frac{\partial H_x}{\partial y}-J_z
				\right)^{n+\frac{1}{2}}=\\&
				\frac{\partial D_z^{n+\frac{1}{2}}}{\partial t} =
				\delta_t D_z - \frac{\Delta t^2}{24} \frac{\partial}{\partial t}
				\left(
				div(\mu^{-1}\nabla E_z)-div(\mu^{-1}\frac{\partial \vec{E}}{\partial z})
				-\frac{\partial J_z}{\partial t}
				\right)+O(\Delta t	)^4= \\&
				\varepsilon \delta_t  E_z - \frac{\Delta t^2}{24}
				\left(
				div(\mu^{-1} \nabla \delta_t  E_z)
				- div\left (\mu^{-1}\frac{\partial ^2\vec{E}}{\partial t \partial z}
				\right)
				-\frac{\partial^2 J_z}{\partial t^2}
				\right)
				+O(\Delta t	)^4.
			\end{align*}
			The term 
			$$
			\left ( \frac{\partial H_y}{\partial x}-
			\frac{\partial H_x}{\partial y}-J_z
			\right)^{n+\frac{1}{2}}
			$$
			can be approximated to fourth order using the Pade approximation given in Appendix \ref{appendix} \cite{yefet_turkel}(see Section \ref{sec:TE}). 
			The term
			$$
			div\left(\mu^{-1}\frac{\partial^2\vec{E}}{\partial t \partial z}\right )^{n+\frac{1}{2}}
			=div\left(
			\mu^{-1}\frac{\partial }{ \partial z}\frac{1}{\varepsilon}(
			\nabla \times \vec{H} -\vec{J}
			)
			\right)^{n+\frac{1}{2}}
			$$
			can be estimated from the previous
			time  step to the second order  accuracy in $h$ since it is already multiplied by $\Delta t ^2$. 
			In fact, since $div(\nabla\times H)=0$ we have to approximate to second order only first and second derivatives  of $\vec{H}$.
			Hence,
			$E_z^{n+1}=E^n+\Delta t\cdot \delta_t E_z$ where 
			$\delta_t E_z$ solves the non-negative symmetric  elliptic equation
			\begin{equation}\label{eq:elliptic_div}
				\varepsilon \delta_t E_z-\frac{\Delta t^2}{24}div(\mu^{-1}\nabla \delta_t E_z)=F^{n+\frac{1}{2}},
			\end{equation}
			where 
			$$
			F^{n+\frac{1}{2}}=
			\left ( \frac{\partial H_y}{\partial x}-
			\frac{\partial H_x}{\partial y}-J_z
			\right)^{n+\frac{1}{2}}+\frac{\Delta t^2}{24}\left (
			div\left(
			\mu^{-1}\frac{\partial }{ \partial z}\frac{1}{\varepsilon}(
			\nabla \times \vec{H} -\vec{J}
			)
			\right )-\frac{\partial^2J_z}{\partial t^2}
			\right)^{n+\frac{1}{2}}.
			$$
			For fourth order compact schemes for \eqref{eq:elliptic_div} see \cite{britt_tsy_tur}. 
				\subsection{Boundary conditions for $\delta_t \vec{E}$ and  $\delta_t \vec{H}$}
			In order to solve \eqref{eq:elliptic_div} to fourth order  one has to supply certain (Dirichlet) boundary conditions for $\delta_t \vec{E}$ and  $\delta_t \vec{H}$ to fourth order.
			We will show the construction in the first  time step. The next steps  will then follow by the staggered structure.
			We assume that $E^0$ and $H^{\frac{1}{2}}$ are given to fourth order.
			For $H^{\frac{1}{2}}$ this can be done using  standard Taylor approximation.
			Next,
			$$
			\frac{\vec{E}^{1}-\vec{E}^{0}}{\Delta t}=\frac{\partial \vec{E}^{\frac{1}{2}}}{\partial t}+
			\Delta t^2\frac{\partial^3 \vec{E}^{\frac{1}{2}}}{\partial t^3}+O(\Delta t^4).
			$$
			The equation for $\vec{E}$ imply that 
			$$
			\frac{\partial \vec{E}^{\frac{1}{2}}}{\partial t}=\varepsilon^{-1}\cdot \nabla \times \vec{H}^{\frac{1}{2}}.
			$$
			The latter term is known to fourth order  and therefore can be approximated using Pad'e scheme in Appendix \ref{appendix} to fourth order. 
			Next we consider the term 
			\begin{align*}
				&
				\frac{\partial^3 \vec{E}^{\frac{1}{2}}}{\partial t^3} =
				\varepsilon^{-1}\nabla \times  \frac{\partial^2 H^{\frac{1}{2}}}{\partial t^2}=
				\\&
				-\varepsilon^{-1}\nabla\times \mu^{-1}
				\nabla \times \frac{\partial \vec{E}^{\frac{1}{2}}}{\partial t}=
				-\varepsilon^{-1}\nabla\times \mu^{-1} \nabla \times
				\varepsilon^{-1}\nabla\times \vec{H}^{\frac{1}{2}}.
			\end{align*}
			The term $ \nabla\times \vec{H}^{\frac{1}{2}}$ is known to fourth order and therefore it is sufficient to approximate its  second-derivatives to second order. Since 
			$\frac{\partial^3 \vec{E}^{\frac{1}{2}}}{\partial t^3}$ is multiplied by $\Delta t^2$ we have accomplished our estimation to order $h^4+\Delta t^2h^2$.
			We demonstrate the above construction   in the following section.
			
			
			\begin{center}
				{\bf Acknowledgments}
			\end{center}
			\begin{thebibliography}{99}
				
				
				\bibitem{britt_tsy_tur}					
				Britt, Steven, Semyon Tsynkov, and Eli Turkel. "Numerical simulation of time-harmonic waves in inhomogeneous media using compact high order schemes." Communications in Computational Physics 9.3 (2011): 520-541.		
				\bibitem{GKO}
Gustafsson, Bertil, Heinz-Otto Kreiss, and Joseph Oliger. Time dependent problems and difference methods. Vol. 24. John Wiley and Sons, 1995.
			
				\bibitem{Morton}
				Morton,K.W.,Mayers,D.F.:NumericalSolutionofPartialDifferentialEquations,2ndedn.Cambridge
				University Press, (2005)
				\bibitem{chen}
				Chen, Wenbin, Xingjie Li, and Dong Liang. "Energy-conserved splitting FDTD methods for Maxwell?s equations." Numerische Mathematik 108.3 (2008): 445-485.
				
				\bibitem{rolf}
				Leis, Rolf. Initial boundary value problems in mathematical physics. Courier Corporation, 2013.
				\bibitem{sakka}
				Sakkaplangkul, Puttha, and V. Bokil. "CONVERGENCE ANALYSIS OF YEE-FDTD SCHEMES FOR 3D MAXWELL?S EQUATIONS IN LINEAR DISPERSIVE MEDIA." International journal of numerical analysis and modeling 18.4 (2021).	
				\bibitem{singer_turkel}
				I. ~Singer, and E.~ Turkel. "High-order finite difference methods for the Helmholtz equation." Computer methods in applied mechanics and engineering 163.1-4 (1998): 343-358.					
				\bibitem{yee}
				K.~Yee, Numerical solution of initial boundary value problems involving Maxwell's equations in isotropic media, {\em IEEE Transactions on antennas and propagation} {\bf 14.3} (1966), 302-307.
				\bibitem{yefet_turkel}
				A.~Yefet and E.~Turkel,
				Fourth Order Compact Implicit Method for the Maxwell Equations with Discontinuous Coefficients
				{\em Applied Numerical Mathematics}  {\bf 33} (2000), 125--134.
			\end{thebibliography}
		\end{document}